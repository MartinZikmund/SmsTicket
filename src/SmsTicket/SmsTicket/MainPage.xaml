<Page
    x:Class="SmsTicket.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SmsTicket"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:SmsTicket.Data.Models"
    xmlns:android="http://uno.ui/android"
    xmlns:toolkit="using:Uno.UI.Toolkit"
    x:Name="Page"
    RequestedTheme="Dark"
    mc:Ignorable="d">
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.ThemeDictionaries>
                <ResourceDictionary x:Key="Default">
                    <Style x:Key="BackgroundCurtainStyle" TargetType="Border">
                        <Setter Property="Opacity" Value="0.6" />
                    </Style>
                </ResourceDictionary>
                <ResourceDictionary x:Key="Light">
                    <Style x:Key="BackgroundCurtainStyle" TargetType="Border">
                        <Setter Property="Opacity" Value="0.5" />
                    </Style>
                </ResourceDictionary>
            </ResourceDictionary.ThemeDictionaries>
            <Style x:Key="SendButtonStyle" TargetType="Button">
                <Setter Property="Background"
				Value="{ThemeResource LightAppAccentBrush}" />
                <Setter Property="Foreground"
				Value="White" />
                <Setter Property="BorderBrush"
				Value="{ThemeResource SystemControlForegroundTransparentBrush}" />
                <Setter Property="BorderThickness"
				Value="{ThemeResource ButtonBorderThemeThickness}" />
                <Setter Property="Padding"
				Value="8,4,8,4" />
                <Setter Property="HorizontalAlignment"
				Value="Left" />
                <Setter Property="VerticalAlignment"
				Value="Center" />
                <Setter Property="FontFamily"
				Value="{ThemeResource ContentControlThemeFontFamily}" />
                <Setter Property="FontWeight"
				Value="Normal" />
                <Setter Property="FontSize"
				Value="{ThemeResource ControlContentThemeFontSize}" />
                <Setter Property="UseSystemFocusVisuals"
				Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid x:Name="RootGrid" CornerRadius="2"
						  Background="{TemplateBinding Background}">
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup x:Name="CommonStates">
                                        <VisualState x:Name="Normal">
                                            <!--<Storyboard>
										<PointerUpThemeAnimation Storyboard.TargetName="RootGrid" />
									</Storyboard>-->
                                        </VisualState>
                                        <VisualState x:Name="PointerOver">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
																	   Storyboard.TargetProperty="BorderBrush">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
																	Value="{ThemeResource DarkAppAccentBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
																	   Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
																	Value="{ThemeResource SystemControlHighlightBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <!--<PointerUpThemeAnimation Storyboard.TargetName="RootGrid" />-->
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Pressed">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootGrid"
																	   Storyboard.TargetProperty="Background">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
																	Value="{ThemeResource DarkAppAccentBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
																	   Storyboard.TargetProperty="BorderBrush">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
																	Value="{ThemeResource SystemControlHighlightTransparentBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <!--<PointerDownThemeAnimation Storyboard.TargetName="RootGrid" />-->
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Disabled">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootGrid"
																	   Storyboard.TargetProperty="Background">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
																	Value="{ThemeResource SystemControlBackgroundBaseLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
																	   Storyboard.TargetProperty="BorderBrush">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
																	Value="{ThemeResource SystemControlDisabledTransparentBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                                <ContentPresenter x:Name="ContentPresenter"
										  BorderBrush="{TemplateBinding BorderBrush}"
										  BorderThickness="{TemplateBinding BorderThickness}"
										  Content="{TemplateBinding Content}"
										  ContentTransitions="{TemplateBinding ContentTransitions}"
										  ContentTemplate="{TemplateBinding ContentTemplate}"
										  ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
										  Padding="{TemplateBinding Padding}"
										  HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
										  VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
										  AutomationProperties.AccessibilityView="Raw" />
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>

    </Page.Resources>
    <Grid x:Name="ContentRoot" toolkit:VisibleBoundsPadding.PaddingMask="All" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState x:Name="NarrowState" />
                <VisualState x:Name="WideState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="600" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="InnerGrid.Width" Value="460" />
                        <Setter Target="TitleTextBlock.HorizontalAlignment" Value="Center" />
                        <Setter Target="InnerGrid.HorizontalAlignment" Value="Center" />
                        <Setter Target="InnerGrid.VerticalAlignment" Value="Center" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Image Source="/Assets/tramvaj.jpg" Stretch="UniformToFill" Grid.RowSpan="2" />
        <Border Style="{ThemeResource BackgroundCurtainStyle}" Grid.RowSpan="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" />

        <ScrollViewer VerticalScrollBarVisibility="Auto" VerticalScrollMode="Auto" HorizontalScrollMode="Disabled" HorizontalScrollBarVisibility="Disabled">
            <Grid x:Name="InnerGrid" VerticalAlignment="Top" HorizontalAlignment="Stretch">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Border>
                    <TextBlock x:Name="TitleTextBlock" Text="{x:Bind Localizer.SMSTicket}" FontWeight="Bold" HorizontalAlignment="Center" Margin="12" Style="{ThemeResource HeaderTextBlockStyle}" />
                </Border>
                <StackPanel Grid.Row="1" Margin="12,0,12,12">
                    <TextBlock Text="{x:Bind Localizer.City, Converter={StaticResource StringToUpperConverter}}" FontSize="16" FontWeight="SemiBold" Style="{ThemeResource SubheaderTextBlockStyle}" Margin="0,0,0,8" />
                    <ComboBox CornerRadius="2" ItemsSource="{x:Bind Model.Cities, Mode=OneWay}" SelectedItem="{Binding ElementName=Page, Path=Model.SelectedCity, Mode=TwoWay}" BorderThickness="1" HorizontalAlignment="Stretch" Margin="0,0,0,12" Padding="0">
                        <ComboBox.ItemTemplate>
                            <DataTemplate x:DataType="models:City">
                                <Grid CornerRadius="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Border Background="{ThemeResource LightAppAccentBrush}" Padding="8" Margin="0,0,8,0" CornerRadius="2">
                                        <TextBlock Foreground="White" FontSize="16" VerticalAlignment="Center" FontWeight="Bold" HorizontalAlignment="Center" Text="{x:Bind Abbreviation}" />
                                    </Border>
                                    <TextBlock Text="{x:Bind Name}" VerticalAlignment="Center" FontSize="16" Grid.Column="1" FontWeight="Normal" />
                                </Grid>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <!--<ToggleSwitch IsOn="{x:Bind Model.UseGps, Mode=TwoWay}" OnContent="GPS On" OffContent="GPS Off" HorizontalAlignment="Left" />-->
                    <TextBlock Text="{x:Bind Localizer.TicketType, Converter={StaticResource StringToUpperConverter}}" FontSize="16" FontWeight="SemiBold" Style="{ThemeResource SubheaderTextBlockStyle}" Margin="0,0,0,8" />
                    <ComboBox CornerRadius="2" Height="68" ItemsSource="{x:Bind Model.SelectedCity.TicketTypes, Mode=OneWay}" VerticalContentAlignment="Center" SelectedItem="{Binding ElementName=Page, Path=Model.SelectedTicketType, Mode=TwoWay}" Padding="0" BorderThickness="1" HorizontalAlignment="Stretch" Margin="0,0,0,12" >
                        <ComboBox.ItemTemplate>
                            <DataTemplate x:DataType="models:TicketType">
                                <Grid Height="68" CornerRadius="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid Background="{ThemeResource LightAppAccentBrush}" Padding="8" Margin="0,0,8,0" CornerRadius="2">
                                        <Image Source="/Assets/ticket_dupe_light.png" Width="24" Height="24" VerticalAlignment="Center" HorizontalAlignment="Center" Visibility="{x:Bind TimeText, Converter={StaticResource StringEmptyVisibilityConverter}}" />
                                        <TextBlock Grid.Column="0" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{x:Bind TimeText}" Visibility="{x:Bind TimeText, Converter={StaticResource StringNotEmptyVisibilityConverter}}" FontWeight="Bold" Foreground="White" />
                                    </Grid>
                                    <Grid Grid.Column="1" VerticalAlignment="Center">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <StackPanel HorizontalAlignment="Left" Orientation="Horizontal">
                                            <TextBlock FontSize="16" FontWeight="Normal">
                                                    <Run Text="{x:Bind Price}" />
                                                    <Run Text="{Binding Source={StaticResource Localizer}, Path=[CzechPriceTag]}" />
                                            </TextBlock>
                                            <TextBlock Margin="8,0,0,0" FontSize="16" Opacity="0.5" VerticalAlignment="Center" TextWrapping="Wrap" Visibility="{x:Bind SmsPriceAdditional, Converter={StaticResource BoolToVisibilityConverter}}" Text="{Binding Source={StaticResource Localizer}, Path=PlusPriceOfSms}" />
                                        </StackPanel>
                                        <TextBlock Visibility="{x:Bind Description, Converter={StaticResource StringNotEmptyVisibilityConverter}, Mode=OneWay}" TextAlignment="Left" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Left" Text="{x:Bind Description}" TextWrapping="Wrap" Grid.Row="1" />
                                    </Grid>
                                </Grid>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <Grid Height="64">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="Auto"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <!-- TODO WTF going on with the CornerRadius? -->
                        <Button CornerRadius="4" VerticalAlignment="Stretch" Style="{StaticResource SendButtonStyle}" Margin="0,0,0,12" Command="{x:Bind Model.PrepareForSendCommand}" HorizontalAlignment="Stretch" Padding="8" FontSize="16">
                            <StackPanel Spacing="12" VerticalAlignment="Stretch" Orientation="Horizontal">
                                <Viewbox Height="32">
                                    <Path Margin="0,0,0,2" VerticalAlignment="Center" Fill="White" Data="M 15.5 5 C 13.205 5 11.18725 6.199 10.03125 8 L 33.5 8 C 37.636 8 41 11.364 41 15.5 L 41 31.96875 C 42.801 30.81175 44 28.795 44 26.5 L 44 15.5 C 44 9.71 39.29 5 33.5 5 L 15.5 5 z M 10.5 10 C 6.9280619 10 4 12.928062 4 16.5 L 4 30.462891 C 4 34.034829 6.9280619 36.962891 10.5 36.962891 L 11 36.962891 L 11 41.498047 C 11 43.449299 13.392719 44.667807 14.970703 43.519531 L 23.988281 36.962891 L 32.5 36.962891 C 36.071938 36.962891 39 34.034829 39 30.462891 L 39 16.5 C 39 12.928062 36.071938 10 32.5 10 L 10.5 10 z M 10.5 13 L 32.5 13 C 34.450062 13 36 14.549938 36 16.5 L 36 30.462891 C 36 32.412953 34.450062 33.962891 32.5 33.962891 L 23.5 33.962891 A 1.50015 1.50015 0 0 0 22.617188 34.248047 L 14 40.515625 L 14 35.462891 A 1.50015 1.50015 0 0 0 12.5 33.962891 L 10.5 33.962891 C 8.5499381 33.962891 7 32.412953 7 30.462891 L 7 16.5 C 7 14.549938 8.5499381 13 10.5 13 z M 15.5 21.962891 C 14.672 21.962891 14 22.634891 14 23.462891 C 14 24.290891 14.672 24.962891 15.5 24.962891 C 16.328 24.962891 17 24.290891 17 23.462891 C 17 22.634891 16.328 21.962891 15.5 21.962891 z M 21.5 21.962891 C 20.672 21.962891 20 22.634891 20 23.462891 C 20 24.290891 20.672 24.962891 21.5 24.962891 C 22.328 24.962891 23 24.290891 23 23.462891 C 23 22.634891 22.328 21.962891 21.5 21.962891 z M 27.5 21.962891 C 26.672 21.962891 26 22.634891 26 23.462891 C 26 24.290891 26.672 24.962891 27.5 24.962891 C 28.328 24.962891 29 24.290891 29 23.462891 C 29 22.634891 28.328 21.962891 27.5 21.962891 z" />
                                </Viewbox>
                                <TextBlock VerticalAlignment="Center" Text="{x:Bind Localizer.PrepareToSend, FallbackValue=Test}" />
                            </StackPanel>
                        </Button>
                        <Button Command="{Binding TogglePinCommand}" Width="52" Grid.Column="1" Margin="4,0,0,12"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Style="{StaticResource SendButtonStyle}">
                            <Viewbox Height="24" Width="24" HorizontalAlignment="Center">
                                <Canvas Width="48" Height="48">
                                    <Path Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Center" Fill="White" Visibility="{Binding IsPinned, Converter={StaticResource InvertedBoolToVisibilityConverter}}" Data="M 18.996094 5.0234375 C 17.822732 4.9942935 16.634501 5.4104206 15.730469 6.3144531 L 6.3144531 15.728516 A 1.50015 1.50015 0 0 0 6.3144531 15.730469 C 4.2487592 17.797645 4.7260031 21.353061 7.2636719 22.802734 L 17.363281 28.576172 L 21.15625 38.056641 A 1.50015 1.50015 0 0 0 23.609375 38.560547 L 30.025391 32.146484 L 40.439453 42.560547 A 1.50015 1.50015 0 1 0 42.560547 40.439453 L 32.146484 30.025391 L 38.5625 23.609375 A 1.50015 1.50015 0 0 0 38.058594 21.15625 L 28.576172 17.363281 L 22.804688 7.2636719 A 1.50015 1.50015 0 0 0 22.804688 7.2617188 C 22.079308 5.9932276 20.826855 5.2404336 19.498047 5.0625 C 19.331946 5.0402583 19.163717 5.0276009 18.996094 5.0234375 z M 18.777344 7.984375 C 18.887026 7.9733548 18.997108 7.9757178 19.105469 7.9902344 C 19.538911 8.0483004 19.945598 8.308441 20.199219 8.7519531 L 26.232422 19.306641 A 1.50015 1.50015 0 0 0 26.976562 19.955078 L 34.832031 23.095703 L 23.095703 34.832031 L 19.955078 26.976562 A 1.50015 1.50015 0 0 0 19.306641 26.230469 L 8.7519531 20.199219 C 7.8662335 19.693241 7.7168954 18.574434 8.4375 17.851562 L 8.4375 17.849609 L 17.851562 8.4375 C 18.122177 8.1668851 18.448297 8.0174357 18.777344 7.984375 z" />
                                    <Path Margin="0,0,0,0" VerticalAlignment="Center" Fill="White" Visibility="{Binding IsPinned, Converter={StaticResource BoolToVisibilityConverter}}" Data="M 42.470703 3.9863281 A 1.50015 1.50015 0 0 0 41.439453 4.4394531 L 4.4394531 41.439453 A 1.50015 1.50015 0 1 0 6.5605469 43.560547 L 18.558594 31.5625 L 21.15625 38.056641 C 21.34425 38.524641 21.752094 38.86775 22.246094 38.96875 C 22.347094 38.98975 22.447828 39 22.548828 39 C 22.942828 39 23.324375 38.844547 23.609375 38.560547 L 30.023438 32.144531 L 40.439453 42.560547 A 1.50015 1.50015 0 1 0 42.560547 40.439453 L 32.144531 30.023438 L 38.560547 23.609375 C 38.916547 23.253375 39.071703 22.742047 38.970703 22.248047 C 38.868703 21.753047 38.524641 21.34325 38.056641 21.15625 L 31.5625 18.558594 L 43.560547 6.5605469 A 1.50015 1.50015 0 0 0 42.470703 3.9863281 z M 18.980469 5 C 17.76966 4.9771816 16.604594 5.4412031 15.730469 6.3144531 L 6.3144531 15.730469 C 5.3164531 16.728469 4.8510625 18.102953 5.0390625 19.501953 C 5.2270625 20.899953 6.0386719 22.103734 7.2636719 22.802734 L 14.642578 27.019531 L 16.841797 24.820312 L 8.7519531 20.199219 C 8.3459531 19.967219 8.0756719 19.567516 8.0136719 19.103516 C 7.9506719 18.639516 8.1065 18.182562 8.4375 17.851562 L 17.851562 8.4355469 C 18.134563 8.1535469 18.508391 8 18.900391 8 C 18.966391 8 19.035516 8.0046719 19.103516 8.0136719 C 19.567516 8.0766719 19.965266 8.3449531 20.197266 8.7519531 L 24.820312 16.841797 L 27.019531 14.642578 L 22.804688 7.2636719 C 22.104688 6.0376719 20.901953 5.2260625 19.501953 5.0390625 C 19.327828 5.0156875 19.153441 5.0032598 18.980469 5 z M 29.253906 20.867188 L 34.830078 23.097656 L 23.097656 34.830078 L 20.867188 29.253906 L 29.253906 20.867188 z " />
                                </Canvas>
                            </Viewbox>
                        </Button>
                    </Grid>
                </StackPanel>
            </Grid>
        </ScrollViewer>


    </Grid>
</Page>
